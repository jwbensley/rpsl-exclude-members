<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Explicitly excluding objects from RPSL sets</title>
<meta content="James Bensley" name="author">
<meta content="
       This document updates   and   by defining the  excl-members  attribute on as-set and route-set classes in the Routing Policy Specification Language (RPSL). This new attribute allows operators to overcome limitations of the existing syntax, which currently only supports the implicit inclusion of everything contained within an as-set or route-set. 
    " name="description">
<meta content="xml2rfc 3.28.0" name="generator">
<meta content="draft-bensley-rpsl-exclude-members-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.7
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 68.1.2
    wcwidth 0.2.13
-->
<link href="draft-bensley-rpsl-exclude-members.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Explicitly excluding objects from RPSL s</td>
<td class="right">March 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Bensley</td>
<td class="center">Expires 25 September 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-bensley-rpsl-exclude-members-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-03-24" class="published">24 March 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-09-25">25 September 2025</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Bensley</div>
<div class="org">Inter.link GmbH</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Explicitly excluding objects from RPSL sets</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document updates <span>[<a href="#RFC2622" class="cite xref">RFC2622</a>]</span> and <span>[<a href="#RFC4012" class="cite xref">RFC4012</a>]</span> by defining the <code>excl-members</code> attribute on as-set and route-set classes in the Routing Policy Specification Language (RPSL). This new attribute allows operators to overcome limitations of the existing syntax, which currently only supports the implicit inclusion of everything contained within an as-set or route-set.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 25 September 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-existing-methods-of-inclusi" class="internal xref">Existing Methods of Inclusion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-existing-methods-of-exclusi" class="internal xref">Existing Methods of Exclusion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-the-need-for-additional-exc" class="internal xref">The Need for Additional Exclusion Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="auto internal xref">1.5</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-the-excl-members-attribute" class="internal xref">The <code>excl-members</code> Attribute</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-the-as-set-class" class="internal xref">The as-set Class</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-the-route-set-class" class="internal xref">The route-set Class</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-attribute-validation" class="internal xref">Attribute Validation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="auto internal xref">2.3.1</a>.  <a href="#name-registry-scoped-keys-only" class="internal xref">Registry Scoped Keys Only</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="auto internal xref">2.3.2</a>.  <a href="#name-any-primary-key-and-registr" class="internal xref">Any Primary Key and Registry Scope</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-exclusion-logic" class="internal xref">Exclusion Logic</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-the-as-set-class-2" class="internal xref">The as-set Class</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-the-route-set-class-2" class="internal xref">The route-set Class</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-cumulative-excludes" class="internal xref">Cumulative Excludes</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-backwards-compatibility" class="internal xref">Backwards Compatibility</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Routing Policy Specification Language (RPSL) <span>[<a href="#RFC2622" class="cite xref">RFC2622</a>]</span> defines the as-set and route-set classes. These sets can either reference a direct member of the set (such as an AS number, IP prefix, etc.), or additional sets which themselves have their own direct members and/or reference yet more sets, ad infinitum. Server and client software can follow these references to recursively resolve all the members of a set i.e., until all references have been resolved leaving a set of prefixes or ASes.<a href="#section-1-1" class="pilcrow">¶</a></p>
<div id="existing-methods-of-inclusion">
<section id="section-1.1">
        <h3 id="name-existing-methods-of-inclusi">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-existing-methods-of-inclusi" class="section-name selfRef">Existing Methods of Inclusion</a>
        </h3>
<p id="section-1.1-1">The existing RPSL syntax allows for members of an as-set or route-set to be specified in multiple ways:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.1-2">
<li id="section-1.1-2.1">
            <p id="section-1.1-2.1.1"><span>[<a href="#RFC2622" class="cite xref">RFC2622</a>]</span> defines the <code>members</code> attribute.<a href="#section-1.1-2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.1-2.1.2">
<li id="section-1.1-2.1.2.1">
                <p id="section-1.1-2.1.2.1.1"><span><a href="https://rfc-editor.org/rfc/rfc2622#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC2622" class="cite xref">RFC2622</a>]</span> defines that for an as-set this attribute stores one or more primary keys, each referencing an aut-num or or as-set object.<a href="#section-1.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-1.1-2.1.2.2">
                <p id="section-1.1-2.1.2.2.1">Sections <a href="https://rfc-editor.org/rfc/rfc2622#section-5.2" class="relref">5.2</a> and <a href="https://rfc-editor.org/rfc/rfc2622#section-5.3" class="relref">5.3</a> of <span>[<a href="#RFC2622" class="cite xref">RFC2622</a>]</span> and  defines that for a route-set this attribute may store one or more primary keys, each referencing a route-set object which optionally has a range operator appended, an aut-num, or an as-set. Alternatively, the <code>members</code> attribute on a route-set may store an IPv4 address prefix range directly i.e., not an RPSL primary key that points directly to route object, and that prefix range is used to identify matching route objects. That address prefix range may optionally have a range operator appended.<a href="#section-1.1-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</li>
          <li id="section-1.1-2.2">
            <p id="section-1.1-2.2.1"><span><a href="https://rfc-editor.org/rfc/rfc4012#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC4012" class="cite xref">RFC4012</a>]</span> defines the <code>mp-members</code> attribute for route-sets. This attribute may store one or more primary keys, each referencing a route-set object which optionally has a range operator appended, or an IPv4 address prefix range directly, or an IPv6 address prefix range directly. Although not explicitly stated in RFC4012, implementations of the <code>mp-members</code> attributes have based it on the RFC2622 definition and allowed the attribute to also store the RPSL primary key of aut-nums and as-sets.<a href="#section-1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.1-2.3">
            <p id="section-1.1-2.3.1"><span>[<a href="#RFC2622" class="cite xref">RFC2622</a>]</span> defines the <code>mbrs-by-ref</code> and <code>member-of</code> attributes.<a href="#section-1.1-2.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.1-2.3.2">
<li id="section-1.1-2.3.2.1">
                <p id="section-1.1-2.3.2.1.1"><span><a href="https://rfc-editor.org/rfc/rfc2622#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC2622" class="cite xref">RFC2622</a>]</span> defines that for an as-set these attributes allow for the inclusion of aut-nums in the as-set, iff the criteria defined in the RFC linking both attributes together is met.<a href="#section-1.1-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-1.1-2.3.2.2">
                <p id="section-1.1-2.3.2.2.1"><span><a href="https://rfc-editor.org/rfc/rfc2622#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC2622" class="cite xref">RFC2622</a>]</span> defines that for a route-set these attributes allow for the inclusion of routes in the route-set, iff the criteria defined in the RFC linking both attributes together is met.<a href="#section-1.1-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</li>
          <li id="section-1.1-2.4">
            <p id="section-1.1-2.4.1"><span><a href="https://rfc-editor.org/rfc/rfc4012#section-3" class="relref">Section 3</a> of [<a href="#RFC4012" class="cite xref">RFC4012</a>]</span> defines the router6 class along with the <code>member-of</code> attribute on that class, and as a result, allows for the inclusion of route6 objects in a route-set, iff the criteria relating to <code>mbrs-by-ref</code> and <code>member-of</code> attributes defined in <span><a href="https://rfc-editor.org/rfc/rfc2622#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC2622" class="cite xref">RFC2622</a>]</span> is met.<a href="#section-1.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-1.1-3">When using the <code>(mp-)members</code> attribute to include an as-set or route-set (hereinafter the "included set") inside another as-set or route-set (hereinafter the "including set"), all members of the included set are included in the including set. This is not limited to the members directly nested inside the included set, but all members recursively included all the way down the RPSL hierarchy. This implicit recursive inclusion logic is herein referred to as "greedy" logic.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">In the figure below, the as-set <code>AS-EXAMPLE-1</code> only includes one member but, as a result of that single inclusion, AS-EXAMPLE-1 now contains the aut-nums AS65001, AS65002, and AS65003:<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<span id="name-a-three-level-hierarchy-is-"></span><figure id="figure-1">
          <div class="lang-rpsl sourcecode" id="section-1.1-5.1">
<pre>
as-set: AS-EXAMPLE-1
members: AS-EXAMPLE-2

as-set: AS-EXAMPLE-2
members: AS65001, AS65002, AS-EXAMPLE-3

as-set: AS-EXAMPLE-3
members: AS65003
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-a-three-level-hierarchy-is-" class="selfRef">A three level hierarchy is created even though AS-EXAMPLE-1 only includes one additional as-set</a>
          </figcaption></figure>
<p id="section-1.1-6">The same inclusion logic applies to a route-set which references another route-set, as-set, or aut-num, in the <code>members</code> attribute; everything inside the included set, all the way down the recursed tree, is implicitly included into the including set.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<p id="section-1.1-7">Similarly greedy logic also applies to prefixes too; the <code>(mp-)members</code> attribute of a route-set includes any route/route6 objects which match the IPv4/6 address prefix range and optional range operator.<a href="#section-1.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="existing-methods-of-exclusion">
<section id="section-1.2">
        <h3 id="name-existing-methods-of-exclusi">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-existing-methods-of-exclusi" class="section-name selfRef">Existing Methods of Exclusion</a>
        </h3>
<p id="section-1.2-1">The filter-set class and <code>filter</code> attribute are defined in <span><a href="https://rfc-editor.org/rfc/rfc2622#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC2622" class="cite xref">RFC2622</a>]</span>. Correspondingly, the <code>mp-filter</code> attribute was later defined in <span><a href="https://rfc-editor.org/rfc/rfc4012#section-2.5.2" class="relref">Section 2.5.2</a> of [<a href="#RFC4012" class="cite xref">RFC4012</a>]</span>. Together these attributes provide a method for declaring in the IRR ecosystem the prefixes a network will not accept.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">Additionally, the <code>(mp-)filter</code> attribute may be used to exclude route/route6 objects which have been included by the greedy logic of the <code>(mp-)members</code> attribute of a route-set. This is achieved by first including all route/route6 objects which match the IPv4/6 address prefix range and optional range operator in the <code>(mp-)members</code> attribute on the route-set, and then removing any route/route6 objects from this result which match the IPv4/6 address prefix range and optional range operator in the <code>(mp-)members</code> attribute of the filter-set.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">For as-sets and route-sets which use the <code>mbrs-by-ref</code> and <code>member-of</code> attributes, both attributes have to contain corresponding values. This already reduces the greediness of the inclusion logic. It is also already possible to further reduce the greediness. This can be achieved by changing the value of <code>mbrs-by-ref</code> from ANY to a list of specific values, and/or by removing the as-set or route-set primary key from the <code>members-of</code> attribute of an aut-num or route/route6 object.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">There is currently no method to exclude either an aut-num, an as-set, or a route-set, which was included by the greedy logic of the <code>(mp-)members</code> attribute of an as-set or route-set object.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-need-for-additional-exclusion-control">
<section id="section-1.3">
        <h3 id="name-the-need-for-additional-exc">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-the-need-for-additional-exc" class="section-name selfRef">The Need for Additional Exclusion Control</a>
        </h3>
<p id="section-1.3-1">The existing greedy logic of the <code>(mp-)members</code> attribute of as-sets and route-sets, coupled with the inability to alter this logic, can result in various undesired effects for operators. A non-exhaustive list of possible undesirable outcomes follows:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.3-2">
<li id="section-1.3-2.1">
            <p id="section-1.3-2.1.1">A member is added to a set which is not connected to or related to the network operated by the owner of the including set. This allows the including set owner to originate prefixes they aren't authorised to originate. Upstreams and peers of the network owning the including set, aren't able to generate an IRR derived prefix or AS path filter which excludes the unauthorised included set. Note that this can happen anywhere in the set hierarchy; the unauthorised include may be nested many levels down within the including set used by a peer or upstream, making it difficult to get included set removed.<a href="#section-1.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.3-2.2">
            <p id="section-1.3-2.2.1">A member is added to a set which creates a loop when the set is resolved (set A contains set B which contains set A). This can lead to IRR derived prefix or AS path filters either massively expanding in size, or simply not being resolvable.<a href="#section-1.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.3-2.3">
            <p id="section-1.3-2.3.1">A member is added to a set, that set is intended to contain a network's downstreams, but the included set relates to a peer or upstream, not a downstream. The operator of the including set now becomes a transit provider for the operator of the included set. This can also lead to IRR derived prefix or AS path filters massively expanding in size.<a href="#section-1.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.3-2.4">
            <p id="section-1.3-2.4.1">A member is added to a set which relates to an operator who's actions violate a law, a geo-political agreement, or the connectivity terms and conditions, of a peer or upstream of the including set operator. The peer or upstream has no choice but to exclude the included set from their peer's or downstream's IRR derived prefix or AS path filters. However, this currently requires a custom and potentially manual workaround, as there is no standard mechanism to support this in an automated manor.<a href="#section-1.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.3-2.5">
            <p id="section-1.3-2.5.1">A member is added to a set with whom a peer or upstream of the including set operator already has a direct relation. A regulatory requirement may restrict the peer or upstream from exchanging traffic with the operator of the included set via the including set operator, or via any 3rd party operator.<a href="#section-1.3-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-1.3-3">This document updates the RPSL definition in <span>[<a href="#RFC4012" class="cite xref">RFC4012</a>]</span> by introducing the <code>excl-members</code> attribute, which allows the including set operator to exclude aut-nums, as-sets, and route-sets, from the included set, or exclude the included set entirely.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="requirements-language">
<section id="section-1.4">
        <h3 id="name-requirements-language">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.4-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.5">
        <h3 id="name-terminology">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.5-1">In this document, the key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>",
"<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">MAY</span>",
and "<span class="bcp14">OPTIONAL</span>" are to be interpreted as described in BCP 14, RFC 2119
<span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span>.<a href="#section-1.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="the-excl-members-attribute">
<section id="section-2">
      <h2 id="name-the-excl-members-attribute">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-the-excl-members-attribute" class="section-name selfRef">The <code>excl-members</code> Attribute</a>
      </h2>
<p id="section-2-1">The <code>excl-members</code> attribute is defined for the as-set class and route-set class.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="the-as-set-class">
<section id="section-2.1">
        <h3 id="name-the-as-set-class">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-the-as-set-class" class="section-name selfRef">The as-set Class</a>
        </h3>
<p id="section-2.1-1">The new <code>excl-members</code> attribute on the as-set class uses almost exactly the same syntax as the existing <code>members</code> attribute from <span><a href="https://rfc-editor.org/rfc/rfc2622#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC2622" class="cite xref">RFC2622</a>]</span>, in that one or more RPSL primary keys of an aut-num or as-set may be specified. The only difference is that when an as-set is specified in <code>excl-members</code>, the as-set primary key <span class="bcp14">MUST</span> be prefixed with a registry name and a double colon (e.g., <code>SOURCE::</code>). This requirement is to ensure that the correct object is being excluded due to the inherent ambiguity of as-set primary keys in the existing IRR ecosystem (as documented in <span>[<a href="#draft-romijn-grow-rpsl-registry-scoped-members" class="cite xref">draft-romijn-grow-rpsl-registry-scoped-members</a>]</span>).<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2.1-2">
          <dt id="section-2.1-2.1">Attribute:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1"><code>excl-members</code><a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.3">Value:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.4">
            <p id="section-2.1-2.4.1">list of ([<code>as-number</code>] or [<code>registry-name</code>]::[<code>as-set-name</code>])<a href="#section-2.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.5">Type:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.6">
            <p id="section-2.1-2.6.1">optional, multi-valued<a href="#section-2.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="the-route-set-class">
<section id="section-2.2">
        <h3 id="name-the-route-set-class">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-the-route-set-class" class="section-name selfRef">The route-set Class</a>
        </h3>
<p id="section-2.2-1">The new <code>excl-members</code> attribute on the route-set class uses similar syntax as the existing <code>members</code> attribute from Sections <a href="https://rfc-editor.org/rfc/rfc2622#section-5.2" class="relref">5.2</a> and <a href="https://rfc-editor.org/rfc/rfc2622#section-5.3" class="relref">5.3</a> of <span>[<a href="#RFC2622" class="cite xref">RFC2622</a>]</span>, in that one or more RPSL primary keys of an aut-num, an as-set, or route-set may be specified. What is different is that <code>excl-members</code> doesn't accept IPv4/6 address prefix ranges because they can already be filtered using a filter-set. In the case that an as-set or route-set is specified in <code>excl-members</code>, the set primary key <span class="bcp14">MUST</span> be prefixed with a registry name and a double colon (e.g., <code>SOURCE::</code>). This requirement is to ensure that the correct object is being excluded due to the inherent ambiguity of as-set and route-set primary keys in the existing IRR ecosystem (as documented in <span>[<a href="#draft-romijn-grow-rpsl-registry-scoped-members" class="cite xref">draft-romijn-grow-rpsl-registry-scoped-members</a>]</span>).<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2.2-2">
          <dt id="section-2.2-2.1">Attribute:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.2">
            <p id="section-2.2-2.2.1"><code>excl-members</code><a href="#section-2.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.3">Value:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.4">
            <p id="section-2.2-2.4.1">list of ([<code>registry-name</code>]::[<code>route-set-name</code>] or [<code>registry-name</code>]::[<code>as-set-name</code>] or [<code>as-number</code>] or [<code>registry-name</code>]::[<code>route-set-name</code>][<code>range-operator</code>])<a href="#section-2.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.5">Type:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.6">
            <p id="section-2.2-2.6.1">optional, multi-valued<a href="#section-2.2-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="attribute-validation">
<section id="section-2.3">
        <h3 id="name-attribute-validation">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-attribute-validation" class="section-name selfRef">Attribute Validation</a>
        </h3>
<p id="section-2.3-1">When an authoritative IRR registry processes the creation or update of an as-set or route-set object with the <code>excl-members</code> attribute present, it <span class="bcp14">MUST</span> validate the contents of the attribute.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<div id="registry-scoped-keys-only">
<section id="section-2.3.1">
          <h4 id="name-registry-scoped-keys-only">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-registry-scoped-keys-only" class="section-name selfRef">Registry Scoped Keys Only</a>
          </h4>
<p id="section-2.3.1-1">All primary keys in <code>excl-members</code> <span class="bcp14">MUST</span> have a registry scope provided, with the exception of an aut-num primary key.<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-2.3.1-2">By requiring registry scoped as-set and route-set keys to be used in the <code>excl-members</code> attribute, it becomes possible to have multiple references to the same RPSL primary key. This is not permitted, and IRR registry software <span class="bcp14">MUST</span> reject this:<a href="#section-2.3.1-2" class="pilcrow">¶</a></p>
<span id="name-invalid-object-fragment-usi"></span><figure id="figure-2">
            <div class="lang-rpsl sourcecode" id="section-2.3.1-3.1">
<pre>
excl-members: RIPE::AS-EXAMPLE, ARIN::AS-EXAMPLE
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-invalid-object-fragment-usi" class="selfRef">Invalid object fragment using multiple registry prefixes with the same RPSL primary key</a>
            </figcaption></figure>
<p id="section-2.3.1-4">The IRR registry software <span class="bcp14">MUST</span> verify that without their registry prefix, all references from <code>excl-members</code> are unique.<a href="#section-2.3.1-4" class="pilcrow">¶</a></p>
<p id="section-2.3.1-5">If allowed, the attribute <code>excl-members: RIPE::AS-EXAMPLE, ARIN::AS-EXAMPLE</code> would refer to two different set objects, whereas the <code>(mp-)members</code> attribute can only contain one instance of <code>AS-EXAMPLE</code>, which creates ambiguity regarding which set the exclusion refers to, when sets exist in multiple registries with the same primary key.<a href="#section-2.3.1-5" class="pilcrow">¶</a></p>
<p id="section-2.3.1-6">Similarly, the IRR software <span class="bcp14">MUST NOT</span> allow for the registry scopes in the <code>excl-members</code> attribute and the <code>src-members</code> attribute to be mixed, when both attributes are populated on the same set object, and when they referencing the same primary key with the registry scope removed.<a href="#section-2.3.1-6" class="pilcrow">¶</a></p>
<span id="name-invalid-object-fragment-usin"></span><figure id="figure-3">
            <div class="lang-rpsl sourcecode" id="section-2.3.1-7.1">
<pre>
member: AS-EXAMPLE
src-members: ARIN::AS-EXAMPLE
excl-members: RIPE::AS-EXAMPLE
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-invalid-object-fragment-usin" class="selfRef">Invalid object fragment using different registry prefixes with the same RPSL primary key across attributes</a>
            </figcaption></figure>
<p id="section-2.3.1-8">If allowed, due to the presence of the <code>src-members</code> attribute, ARIN::AS-EXAMPLE is included instead of AS-EXAMPLE (<code>src-members</code> is taking preference over <code>members</code>), and the <code>excl-members</code> attribute value RIPE::AS-EXAMPLE wouldn't match the <code>src-members</code> value.<a href="#section-2.3.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="any-primary-key-and-registry-scope">
<section id="section-2.3.2">
          <h4 id="name-any-primary-key-and-registr">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-any-primary-key-and-registr" class="section-name selfRef">Any Primary Key and Registry Scope</a>
          </h4>
<p id="section-2.3.2-1">The IRR software <span class="bcp14">MUST NOT</span> require that the primary key of an entry in the <code>excl-members</code> attribute is also a direct member of the object being created or updated. The <code>excl-members</code> attribute is used to exclude objects anywhere in the hierarchy, starting from the point of definition, moving downwards within the hierarchy. This is because the object to be excluded, might be being included by a member, of a member, of a member, for example.<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
<p id="section-2.3.2-2">When creating or updating an object with the <code>excl-members</code> attribute, the authoritative IRR software <span class="bcp14">MUST NOT</span> require that the registry scope which precedes the object primary key, is a registry the IRR software knows to be a valid registry. An authoritative IRR server may have it's content mirrored to resolver IRR servers, which have visibility of many more registries.<a href="#section-2.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="exclusion-logic">
<section id="section-3">
      <h2 id="name-exclusion-logic">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-exclusion-logic" class="section-name selfRef">Exclusion Logic</a>
      </h2>
<div id="the-as-set-class-1">
<section id="section-3.1">
        <h3 id="name-the-as-set-class-2">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-the-as-set-class-2" class="section-name selfRef">The as-set Class</a>
        </h3>
<p id="section-3.1-1">When the <code>excl-members</code> attribute is populated on an as-set object, the primary keys stored in the attribute reference aut-nums or as-sets that <span class="bcp14">MUST NOT</span> be resolved by a resolving IRR server, when recursively resolving the members of that as-set object.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1-2">
<li id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">This exclusion applies to the <code>members</code> attribute of the as-set object which has the <code>excl-members</code> attribute populated, and the <code>members</code> attribute of all recursively resolved as-sets within that set. Because the RPSL primary keys stored in the <code>excl-members</code> attribute have a registry scope prepended, the primary keys in the <code>members</code> attribute <span class="bcp14">MUST</span> be checked against all keys in the <code>excl-members</code> attribute with the registry scope removed.<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">This exclusion applies to the <code>src-members</code> attribute (as defined in <span>[<a href="#draft-romijn-grow-rpsl-registry-scoped-members" class="cite xref">draft-romijn-grow-rpsl-registry-scoped-members</a>]</span>) of the as-set object which has the <code>excl-members</code> attribute populated, and the <code>src-members</code> attribute of all recursively resolved as-sets within that set. In this case the registry scoped RPSL primary keys in <code>src-members</code> <span class="bcp14">MUST</span> match a registry scoped key in <code>excl-members</code> exactly, without the registry scope having being removed from either of the two keys being compared.<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.3">
            <p id="section-3.1-2.3.1">If both <code>members</code> and <code>src-members</code> are defined on an as-set object, and the same key exists in both attributes when the registry scope is removed from the <code>src-members</code> entry, the key from <code>src-members</code> with the registry scope prepended <span class="bcp14">MUST</span> be compared against all entries in <code>excl-members</code>. Matching keys in <code>src-members</code> takes precedence over matching keys in <code>members</code>.<a href="#section-3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.1-3">The figure below shows IRR data in its raw an unresolved state:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<span id="name-an-example-as-set-hierarchy"></span><figure id="figure-4">
          <div class="lang-rpsl sourcecode" id="section-3.1-4.1">
<pre>
as-set: AS-EXAMPLE-1
members: AS-EXAMPLE-2, AS65001
source: ARIN

as-set: AS-EXAMPLE-2
members: AS65002, AS-EXAMPLE-3
excl-members: RIPE::AS-EXAMPLE-4, AS65005, AS65002
source: RIPE

as-set: AS-EXAMPLE-3
members: AS65003, AS65005, AS-EXAMPLE-4
src-members: RIPE::AS-EXAMPLE-4
source: RIPE

as-set: AS-EXAMPLE-4
members: AS65004
source: ARIN
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-an-example-as-set-hierarchy" class="selfRef">An example as-set hierarchy, in it's unresolved state</a>
          </figcaption></figure>
<p id="section-3.1-5">The figure below shows the result from a resolving IRR server having resolved the members of set <code>AS-EXAMPLE-1</code> when the <code>excl-members</code> logic is applied:<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<span id="name-as-example-1-in-its-resolve"></span><figure id="figure-5">
          <div class="lang-rpsl sourcecode" id="section-3.1-6.1">
<pre>
as-set: AS-EXAMPLE-1
members: AS65001, AS65003
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-as-example-1-in-its-resolve" class="selfRef">AS-EXAMPLE-1 in it's resolved state with exclusions applied</a>
          </figcaption></figure>
<ul class="normal">
<li class="normal" id="section-3.1-7.1">
            <p id="section-3.1-7.1.1">It can be seen that <code>excl-members</code> took effect on the object it was defined, not just it's descendants. This is shown by AS65002 not being included in the final result because AS65002 is both a <code>member</code> <em>and</em> <code>excl-members</code> of AS-EXAMPLE-2.<a href="#section-3.1-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-7.2">
            <p id="section-3.1-7.2.1">AS-EXAMPLE-4 is excluded even though AS-EXAMPLE-4 is defined in ARIN and RIPE::AS-EXAMPLE-4 is specified in <code>excl-members</code> on AS-EXAMPLE-2. This is because the AS-EXAMPLE-4 entry in the <code>members</code> attribute of AS-EXAMPLE-3 is ambiguous, but a <code>src-members</code> attribute has been defined which takes precedence over <code>members</code>. The exclusion is applied against the <code>src-members</code> attribute of AS-EXAMPLE-3 (which may be an as-set not displayed here or a non-existing set).<a href="#section-3.1-7.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="the-route-set-class-1">
<section id="section-3.2">
        <h3 id="name-the-route-set-class-2">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-the-route-set-class-2" class="section-name selfRef">The route-set Class</a>
        </h3>
<p id="section-3.2-1">When the <code>excl-members</code> attribute is populated on a route-set object, the primary keys stored in the attribute reference aut-nums, or as-sets, or route-sets, that <span class="bcp14">MUST NOT</span> be resolved by a resolving IRR server, when recursively resolving the members of that route-set object.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-2">
<li id="section-3.2-2.1">
            <p id="section-3.2-2.1.1">This exclusion applies to the <code>(mp-)members</code> attributes of the route-set object which has the <code>excl-members</code> attribute populated, and the <code>(mp-)members</code> attributes of all recursively resolved route-sets and as-sets within that route-set. Because the RPSL primary keys stored in the <code>excl-members</code> attribute have a registry scope prepended, the primary keys in the <code>(mp-)members</code> attributes <span class="bcp14">MUST</span> be checked against all keys in <code>excl-members</code> attribute with the registry scope removed.<a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.2">
            <p id="section-3.2-2.2.1">This exclusion applies to the <code>src-members</code> attribute (as defined in <span>[<a href="#draft-romijn-grow-rpsl-registry-scoped-members" class="cite xref">draft-romijn-grow-rpsl-registry-scoped-members</a>]</span>) of the route-set object which has the <code>excl-members</code> attribute populated, and the <code>src-members</code> attribute of all recursively resolved route-sets and as-sets within that route-set. In this case the registry scoped RPSL primary keys in <code>src-members</code> <span class="bcp14">MUST</span> match a registry scoped key in <code>excl-members</code> exactly, without the registry scope having being removed from either of the two keys being compared.<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.3">
            <p id="section-3.2-2.3.1">If both <code>(mp-)members</code> and <code>src-members</code> are defined on a route-set object, and the same key exists in both attributes when the registry scope is removed from the <code>src-members</code> entry, the key from <code>src-members</code> with the registry scope prepended <span class="bcp14">MUST</span> be compared against all entries in <code>excl-members</code>. Matching keys in <code>src-members</code> takes precedence over matching keys in <code>(mp-)members</code>.<a href="#section-3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.2-3">The figure below shows IRR data in its raw an unresolved state:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<span id="name-an-example-route-set-hierar"></span><figure id="figure-6">
          <div class="lang-rpsl sourcecode" id="section-3.2-4.1">
<pre>
route-set: RS-EXAMPLE-1
members: 192.0.2.0/25, RS-EXAMPLE-2
source: ARIN

route-set: RS-EXAMPLE-2
mp-members: 2001:db8::/33
mp-members: RS-EXAMPLE-3, RS-EXAMPLE-4
src-members: RIPE::RS-EXAMPLE-3, RIPE::RS-EXAMPLE-4
excl-members: RIPE::RS-EXAMPLE-4
source: RIPE

route-set: RS-EXAMPLE-3
members: 192.0.2.128/25, RS-EXAMPLE-4
source: RIPE

route-set: RS-EXAMPLE-4
members: 2001:db8:8000::/33
source: ARIN
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-an-example-route-set-hierar" class="selfRef">An example route-set hierarchy, in it's unresolved state</a>
          </figcaption></figure>
<p id="section-3.2-5">The figure below shows the result from a resolving IRR server having resolved the members of set <code>RS-EXAMPLE-1</code> when the <code>excl-members</code> logic is applied:<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<span id="name-rs-example-1-in-its-resolve"></span><figure id="figure-7">
          <div class="lang-rpsl sourcecode" id="section-3.2-6.1">
<pre>
as-set: RS-EXAMPLE-1
members: 192.0.2.0/25, 2001:db8::/33, 192.0.2.128/25
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-rs-example-1-in-its-resolve" class="selfRef">RS-EXAMPLE-1 in it's resolved state with exclusions applied</a>
          </figcaption></figure>
<ul class="normal">
<li class="normal" id="section-3.2-7.1">
            <p id="section-3.2-7.1.1">It can be seen that <code>excl-members</code> took effect on the object it was defined on, not just it's descendants. This is shown by 2001:db8:8000::/33 not being included in the final result because RS-EXAMPLE-4 is both a <code>member</code> <em>and</em> <code>excl-members</code> of RS-EXAMPLE-2.<a href="#section-3.2-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-7.2">
            <p id="section-3.2-7.2.1">Even though RS-EXAMPLE-4 is excluded by RS-EXAMPLE-2, it was also included by RS-EXAMPLE-3, but still 2001:db8:8000::/33 is excluded. This shows that the exclusion logic applies from the point in the hierarchy where it is defined, all the way down, taking precedence over any subsequent includes.<a href="#section-3.2-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-7.3">
            <p id="section-3.2-7.3.1">RS-EXAMPLE-4 is excluded even though RS-EXAMPLE-4 is defined in ARIN and RIPE::RS-EXAMPLE-4 is specified in <code>excl-members</code> on RS-EXAMPLE-2. This is because the AS-EXAMPLE-4 entry in the <code>(mp-)members</code> attribute of RS-EXAMPLE-3 is ambiguous due to the lack of <code>src-members</code> attribute on RS-EXAMPLE-3. This means that the <code>excl-members</code> value RIPE::RS-EXAMPLE-4 has to be checked against the <code>members</code> attribute on RS-EXAMPLE-3 with the registry scope removed.<a href="#section-3.2-7.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="cumulative-excludes">
<section id="section-3.3">
        <h3 id="name-cumulative-excludes">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-cumulative-excludes" class="section-name selfRef">Cumulative Excludes</a>
        </h3>
<p id="section-3.3-1">As as-set or route-set objects are recursively resolved and <code>excl-members</code> attributes are discovered, the RPSL primary keys to be excluded need to be tracked. At any point in the hierarchy where <code>excl-members</code> is discovered, all <code>(mp-)members</code> and <code>src-members</code> attributes from that point onwards are subject to the <code>excl-members</code> which have been discovered so far. However, depending on the resolution algorithm being used by the resolving software i.e., a depth first search or breadth first search, multiple lists of RPSL keys to exclude may have to be maintained (the exact implementation details are outside the scope of this document).<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">This section does not aim to define how the logic should be implemented in software, simply to demonstrate that the exclusion list is cumulative, but not as simple as a single global list.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">The following figure shows as-set objects in their unresolved state:<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<span id="name-an-example-as-set-hierarchy-"></span><figure id="figure-8">
          <div class="lang-rpsl sourcecode" id="section-3.3-4.1">
<pre>
as-set: AS-EXAMPLE-1
members: AS-EXAMPLE-2, AS-EXAMPLE-3
excl-members: RIPE::AS-EXAMPLE-4

as-set: AS-EXAMPLE-2
members: AS-EXAMPLE-4
excl-members: RIPE::AS-EXAMPLE-5

as-set: AS-EXAMPLE-4
members: AS65004

as-set: AS-EXAMPLE-3
members: AS-EXAMPLE-5
excl-members: AS65006

as-set: AS-EXAMPLE-5
members: AS65005
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-an-example-as-set-hierarchy-" class="selfRef">An example as-set hierarchy, in it's unresolved state</a>
          </figcaption></figure>
<p id="section-3.3-5">The following figure shows the resolved members of as-set AS-EXAMPLE-1:<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<span id="name-as-example-1-in-its-resolved"></span><figure id="figure-9">
          <div class="lang-rpsl sourcecode" id="section-3.3-6.1">
<pre>
as-set: AS-EXAMPLE-1
members: AS65005
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-as-example-1-in-its-resolved" class="selfRef">AS-EXAMPLE-1 in it's resolved state with exclusions applied</a>
          </figcaption></figure>
<ol start="1" type="1" class="normal type-1" id="section-3.3-7">
<li id="section-3.3-7.1">
            <p id="section-3.3-7.1.1">The resolving process starts by resolving the members of AS-EXAMPLE-1.<a href="#section-3.3-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.3-7.2">
            <p id="section-3.3-7.2.1">If a depth first search approach is taken by the IRR software, AS-EXAMPLE-2 might be resolved next. AS-EXAMPLE-4 is not included due to the <code>excl-members</code> attribute defined on AS-EXAMPLE-1. This is being applied from the point of definition onwards, the resolving process inherited the currently defined list of excludes (RIPE::AS-EXAMPLE-4) when it moved on to resolve AS-EXAMPLE-2.<a href="#section-3.3-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.3-7.3">
            <p id="section-3.3-7.3.1">AS-EXAMPLE-2 defined a new <code>excl-members</code> attribute with the value RIPE::AS-EXAMPLE-5 however, there is nothing left to resolve in AS-EXAMPLE-2 so this exclusion has no effect.<a href="#section-3.3-7.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.3-7.4">
            <p id="section-3.3-7.4.1">Continuing the depth first search approach, the IRR software returns to AS-EXAMPLE-1, and uses the exclusion list as it existed whilst resolving AS-EXAMPLE1-1 (it contains only RIPE::AS-EXAMPLE-4), and now begins to resolve AS-EXAMPLE-3.<a href="#section-3.3-7.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.3-7.5">
            <p id="section-3.3-7.5.1">AS-EXAMPLE-3 includes AS-EXAMPLE-5. This is not excluded even though the IRR software has encountered an <code>excl-members</code> attribute which contains the value RIPE::AS-EXAMPLE-5. This is because that <code>excl-members</code> attribute was found on a different branch of the hierarchy.<a href="#section-3.3-7.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.3-7.6">
            <p id="section-3.3-7.6.1">Continuing the resolution process, resolving AS-EXAMPLE-5 returns AS65005 only. The exclusion of AS65006 defined on AS-EXAMPLE-3 was applied to the resolution of AS-EXAMPLE-5 in addition to the exclusion of RIPE::AS-EXAMPLE-4, however no <code>members</code> or <code>src-members</code> attributes were found on AS-EXAMPLE-5 with these values.<a href="#section-3.3-7.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.3-8">The example shows that discovered exclusions do not apply across branches of the hierarchy. This <span class="bcp14">MUST NOT</span> be allowed by the software implementation. If allowed, the operator of an as-set or route-set would be able to excluded objects from other sets they are not responsible for.<a href="#section-3.3-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="backwards-compatibility">
<section id="section-4">
      <h2 id="name-backwards-compatibility">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-backwards-compatibility" class="section-name selfRef">Backwards Compatibility</a>
      </h2>
<p id="section-4-1">The behaviour or RPSL compliant software is to ignore unrecognised attributes. This means that adding the exclusion logic defined in this document based on the contents of a new attribute has no impact when existing IRR software implementations process an object with the new attribute defined.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">This memo includes no request to IANA.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">This document adds the ability to specify that IRR derived prefix and AS path filter lists may exclude specific entries, which may be the cause of security issue, that are presently included by the existing greedy logic.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">It is possible that the operator of an including set includes the wrong primary key in the <code>excl-members</code> attribute. However, this is not a new issue, it has long been possible to include the unintended primary keys in set objects. This document doesn't change this existing behaviour.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Great progress has been made with the deployment of Route Origin Authorizations (ROAs) as defined in <span>[<a href="#RFC9582" class="cite xref">RFC9582</a>]</span>, and the ongoing development of Autonomous System Provider Authorization (ASPA) objects as defined in <span>[<a href="#draft-ietf-sidrops-aspa-verification" class="cite xref">draft-ietf-sidrops-aspa-verification</a>]</span>. The method proposed in this document in intended to compliment those existing developments, further enriching the existing operator's toolkit, and not work against them or be mutually exclusive.<a href="#section-6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2622">[RFC2622]</dt>
        <dd>
<span class="refAuthor">Alaettinoglu, C.</span>, <span class="refAuthor">Villamizar, C.</span>, <span class="refAuthor">Gerich, E.</span>, <span class="refAuthor">Kessens, D.</span>, <span class="refAuthor">Meyer, D.</span>, <span class="refAuthor">Bates, T.</span>, <span class="refAuthor">Karrenberg, D.</span>, and <span class="refAuthor">M. Terpstra</span>, <span class="refTitle">"Routing Policy Specification Language (RPSL)"</span>, <span class="seriesInfo">RFC 2622</span>, <span class="seriesInfo">DOI 10.17487/RFC2622</span>, <time datetime="1999-06" class="refDate">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2622">https://www.rfc-editor.org/rfc/rfc2622</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4012">[RFC4012]</dt>
        <dd>
<span class="refAuthor">Blunk, L.</span>, <span class="refAuthor">Damas, J.</span>, <span class="refAuthor">Parent, F.</span>, and <span class="refAuthor">A. Robachevsky</span>, <span class="refTitle">"Routing Policy Specification Language next generation (RPSLng)"</span>, <span class="seriesInfo">RFC 4012</span>, <span class="seriesInfo">DOI 10.17487/RFC4012</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4012">https://www.rfc-editor.org/rfc/rfc4012</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC9582">[RFC9582]</dt>
        <dd>
<span class="refAuthor">Snijders, J.</span>, <span class="refAuthor">Maddison, B.</span>, <span class="refAuthor">Lepinski, M.</span>, <span class="refAuthor">Kong, D.</span>, and <span class="refAuthor">S. Kent</span>, <span class="refTitle">"A Profile for Route Origin Authorizations (ROAs)"</span>, <span class="seriesInfo">RFC 9582</span>, <span class="seriesInfo">DOI 10.17487/RFC9582</span>, <time datetime="2024-05" class="refDate">May 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9582">https://www.rfc-editor.org/rfc/rfc9582</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="draft-romijn-grow-rpsl-registry-scoped-members">[draft-romijn-grow-rpsl-registry-scoped-members]</dt>
        <dd>
<span class="refAuthor">Romijn, S.</span> and <span class="refAuthor">J. Bensley</span>, <span class="refTitle">"Registry scoped members for RPSL set objects"</span>, <time datetime="2025-02-21" class="refDate">21 February 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/draft-romijn-grow-rpsl-registry-scoped-members/">https://datatracker.ietf.org/doc/draft-romijn-grow-rpsl-registry-scoped-members/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="draft-ietf-sidrops-aspa-verification">[draft-ietf-sidrops-aspa-verification]</dt>
      <dd>
<span class="refAuthor">Azimov, A.</span>, <span class="refAuthor">Bogomazov, E.</span>, <span class="refAuthor">Bush, R.</span>, <span class="refAuthor">Patel, K.</span>, <span class="refAuthor">Snijders, J.</span>, and <span class="refAuthor">K. Sriram</span>, <span class="refTitle">"BGP AS_PATH Verification Based on Autonomous System Provider Authorization (ASPA) Objects"</span>, <time datetime="2025-03-23" class="refDate">23 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/draft-ietf-sidrops-aspa-verification/">https://datatracker.ietf.org/doc/draft-ietf-sidrops-aspa-verification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">James Bensley</span></div>
<div dir="auto" class="left"><span class="org">Inter.link GmbH</span></div>
<div dir="auto" class="left"><span class="street-address">Boxhagener Str. 80</span></div>
<div dir="auto" class="left">
<span class="postal-code">10245</span> <span class="locality">Berlin</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:james@inter.link" class="email">james@inter.link</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
